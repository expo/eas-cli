name: Build Worker (iOS)

on:
  workflow_dispatch:
    inputs:
      upload_artifact:
        description: 'Whether to upload the artifact after building'
        type: boolean
        default: true

jobs:
  build_ios_worker:
    name: Build iOS Worker Tarball
    runs_on: macos-medium
    image: latest
    steps:
      - uses: eas/checkout

      - uses: eas/install_node_modules

      - name: Build worker tarball
        run: ./package.sh worker-ios.tar.gz ios

      - name: Upload worker tarball as artifact
        if: ${{ inputs.upload_artifact }}
        uses: eas/upload_artifact
        with:
          name: worker-ios-tarball
          path: packages/worker/worker-ios.tar.gz
